<html>
<head>
<meta charset="utf-8">

</head>
<body>
    <style>

      .variable-info {
        color:#aaa;
        display: none;
      }

      .comment {
        color: #688e49;
      }
      .keyword{
        color: #5b94cf;
      }

      .secondary-keyword {
        color:#dcdcaa;
      }

      .control-flow {
        color:#b680ba;
      } 

      .args {
        color:#9cdcfe;
      }

      .active-line {
        background: #8e8f32;
        color: #ddd;
      }

      .controls-container {
          background: #1e1e1e;
          width: 216px;
          height: 35px;
          position:absolute;
          bottom:-35px;
          box-shadow: 0px 3px 3px #111;
          border-radius: 0px 0px 4px 4px;
          z-index: 1;
      }

      .controls-container button {
          background: transparent;
          border: none;
          width: 28px;
          height: 28px;
          float: left;
          background-repeat: no-repeat;
          background-position: center;
          padding: 0 20px;
      }

      .controls-container button:hover {
          cursor: pointer;
      }

      .controls-container .play {
          background-size: 20px;
          background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PGRlZnM+PHN0eWxlPi5pY29uLWNhbnZhcy10cmFuc3BhcmVudCwuaWNvbi12cy1vdXR7ZmlsbDojZjZmNmY2O30uaWNvbi1jYW52YXMtdHJhbnNwYXJlbnR7b3BhY2l0eTowO30uaWNvbi12cy1hY3Rpb24tZ3JlZW57ZmlsbDojMzg4YTM0O308L3N0eWxlPjwvZGVmcz48dGl0bGU+Y29udGludWU8L3RpdGxlPjxnIGlkPSJjYW52YXMiPjxwYXRoIGNsYXNzPSJpY29uLWNhbnZhcy10cmFuc3BhcmVudCIgZD0iTTE2LDBWMTZIMFYwWiIvPjwvZz48ZyBpZD0ib3V0bGluZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij48cGF0aCBjbGFzcz0iaWNvbi12cy1vdXQiIGQ9Ik0xNC4zMzQsOCwzLjY2NywxNkgzVjBoLjY2N1oiLz48L2c+PGcgaWQ9Imljb25CZyI+PHBhdGggY2xhc3M9Imljb24tdnMtYWN0aW9uLWdyZWVuIiBkPSJNNCwxLjV2MTNMMTIuNjY3LDgsNCwxLjVaIi8+PC9nPjwvc3ZnPg==');
          border: 1px solid transparent;
          -webkit-transition: border 0.1s linear, box-shadow 0.1s linear;
          -moz-transition: border 0.1s linear, box-shadow 0.1s linear;
          transition: border 0.1s linear, box-shadow 0.1s linear;
      }

      .controls-container .back {
          background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGQ9Ik02IDEzQzYgMTMuMzk1NiA2LjExNzMgMTMuNzgyMiA2LjMzNzA2IDE0LjExMTFDNi41NTY4MiAxNC40NCA2Ljg2OTE4IDE0LjY5NjQgNy4yMzQ2MyAxNC44NDc4QzcuNjAwMDggMTQuOTk5MSA4LjAwMjIyIDE1LjAzODcgOC4zOTAxOCAxNC45NjE2QzguNzc4MTQgMTQuODg0NCA5LjEzNDUxIDE0LjY5MzkgOS40MTQyMSAxNC40MTQyQzkuNjkzOTIgMTQuMTM0NSA5Ljg4NDQgMTMuNzc4MSA5Ljk2MTU3IDEzLjM5MDJDMTAuMDM4NyAxMy4wMDIyIDkuOTk5MTMgMTIuNjAwMSA5Ljg0Nzc2IDEyLjIzNDZDOS42OTYzOCAxMS44NjkyIDkuNDQwMDQgMTEuNTU2OCA5LjExMTE0IDExLjMzNzFDOC43ODIyNCAxMS4xMTczIDguMzk1NTYgMTEgOCAxMUM3LjQ2OTU3IDExIDYuOTYwODYgMTEuMjEwNyA2LjU4NTc5IDExLjU4NThDNi4yMTA3MSAxMS45NjA5IDYgMTIuNDY5NiA2IDEzWiIgZmlsbD0iIzQyNDI0MiIvPgo8cGF0aCBkPSJNMC45OTk5OTggMlY4SDdWNkg0Ljc2M0M1LjI3MzAzIDUuMjMzMjMgNi4wMDY5MyA0LjY0MjI0IDYuODY0ODEgNC4zMDc0MkM3LjcyMjY5IDMuOTcyNjEgOC42NjI5IDMuOTEwMjQgOS41NTc0OSA0LjEyODgxQzEwLjQ1MjEgNC4zNDczNyAxMS4yNTc2IDQuODM2MjYgMTEuODY0NCA1LjUyODkzQzEyLjQ3MTMgNi4yMjE2MSAxMi44NSA3LjA4NDQzIDEyLjk0OSA4SDE0Ljk3NUMxNC44NzMzIDYuNjM1MiAxNC4zNDIyIDUuMzM3NiAxMy40NTc5IDQuMjkzMTJDMTIuNTczNiAzLjI0ODYzIDExLjM4MTMgMi41MTA4NiAxMC4wNTIgMi4xODU0OUM4LjcyMjYyIDEuODYwMTIgNy4zMjQ0IDEuOTYzODUgNi4wNTc2MyAyLjQ4MTgzQzQuNzkwODUgMi45OTk4MSAzLjcyMDUzIDMuOTA1NDUgMyA1LjA2OVYySDAuOTk5OTk4WiIgZmlsbD0iIzAwNTM5QyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMTYgMCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4=');
          margin-left: 20px;
      }

      .controls-container .stop {
          background-size: 20px;
          background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PGRlZnM+PHN0eWxlPi5pY29uLWNhbnZhcy10cmFuc3BhcmVudCwuaWNvbi12cy1vdXR7ZmlsbDojZjZmNmY2O30uaWNvbi1jYW52YXMtdHJhbnNwYXJlbnR7b3BhY2l0eTowO30uaWNvbi12cy1hY3Rpb24tcmVke2ZpbGw6I2ExMjYwZDt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPnN0b3A8L3RpdGxlPjxnIGlkPSJjYW52YXMiPjxwYXRoIGNsYXNzPSJpY29uLWNhbnZhcy10cmFuc3BhcmVudCIgZD0iTTE2LDBWMTZIMFYwWiIvPjwvZz48ZyBpZD0ib3V0bGluZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij48cGF0aCBjbGFzcz0iaWNvbi12cy1vdXQiIGQ9Ik0xNCwyVjE0SDJWMloiLz48L2c+PGcgaWQ9Imljb25CZyI+PHBhdGggY2xhc3M9Imljb24tdnMtYWN0aW9uLXJlZCIgZD0iTTEzLDNWMTNIM1YzWiIvPjwvZz48L3N2Zz4=');
      }

      .controls-container .forward {
          background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGQ9Ik02IDEzQzYgMTMuMzk1NiA2LjExNzMgMTMuNzgyMiA2LjMzNzA2IDE0LjExMTFDNi41NTY4MiAxNC40NCA2Ljg2OTE4IDE0LjY5NjQgNy4yMzQ2MyAxNC44NDc4QzcuNjAwMDggMTQuOTk5MSA4LjAwMjIyIDE1LjAzODcgOC4zOTAxOCAxNC45NjE2QzguNzc4MTQgMTQuODg0NCA5LjEzNDUxIDE0LjY5MzkgOS40MTQyMSAxNC40MTQyQzkuNjkzOTIgMTQuMTM0NSA5Ljg4NDQgMTMuNzc4MSA5Ljk2MTU3IDEzLjM5MDJDMTAuMDM4NyAxMy4wMDIyIDkuOTk5MTMgMTIuNjAwMSA5Ljg0Nzc2IDEyLjIzNDZDOS42OTYzOCAxMS44NjkyIDkuNDQwMDQgMTEuNTU2OCA5LjExMTE0IDExLjMzNzFDOC43ODIyNCAxMS4xMTczIDguMzk1NTYgMTEgOCAxMUM3LjQ2OTU3IDExIDYuOTYwODYgMTEuMjEwNyA2LjU4NTc5IDExLjU4NThDNi4yMTA3MSAxMS45NjA5IDYgMTIuNDY5NiA2IDEzWiIgZmlsbD0iIzQyNDI0MiIvPgo8cGF0aCBkPSJNMC45OTk5OTggMlY4SDdWNkg0Ljc2M0M1LjI3MzAzIDUuMjMzMjMgNi4wMDY5MyA0LjY0MjI0IDYuODY0ODEgNC4zMDc0MkM3LjcyMjY5IDMuOTcyNjEgOC42NjI5IDMuOTEwMjQgOS41NTc0OSA0LjEyODgxQzEwLjQ1MjEgNC4zNDczNyAxMS4yNTc2IDQuODM2MjYgMTEuODY0NCA1LjUyODkzQzEyLjQ3MTMgNi4yMjE2MSAxMi44NSA3LjA4NDQzIDEyLjk0OSA4SDE0Ljk3NUMxNC44NzMzIDYuNjM1MiAxNC4zNDIyIDUuMzM3NiAxMy40NTc5IDQuMjkzMTJDMTIuNTczNiAzLjI0ODYzIDExLjM4MTMgMi41MTA4NiAxMC4wNTIgMi4xODU0OUM4LjcyMjYyIDEuODYwMTIgNy4zMjQ0IDEuOTYzODUgNi4wNTc2MyAyLjQ4MTgzQzQuNzkwODUgMi45OTk4MSAzLjcyMDUzIDMuOTA1NDUgMyA1LjA2OVYySDAuOTk5OTk4WiIgZmlsbD0iIzAwNTM5QyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMTYgMCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4=');
          transform: scaleX(-1);
      }

      .controls-container .play.active {
          border-color: #DAA520;
          -webkit-box-shadow: 0 0 5px #DAA520;
          -moz-box-shadow: 0 0 5px #DAA520;
          box-shadow: 0 0 5px #DAA520;
      }
    </style>

    <script type="text/front-matter">
        title: "AN INTRODUCTION TO ALPHA ZERO THAT I WILL NAME UPON A LATER DATE"
        description: "Description of the post"
        authors:
        - Josh Varty: http://joshvarty.com
        affiliations:
        - None  : http://joshvarty.com
      </script>
      
      <dt-article>
        <h1>Alpha Zero</h1>
        <h2>Four out of five dentists agree that this is absolute most basic introduction to AlphaZero and Monte Carlo Tree Search ever produced by the human race.</h2>
        <dt-byline></dt-byline>


        <h2>A simpler game</h2>

        <p>
          Go has ~2.08x10<sup>170</sup> legal board positions. Chess has ~10<sup>50</sup> legal board positions. Even Tic-Tac-Toe has 5,478 legal board positions.
          If we're going to have any hope of understanding AlphaZero and MCTS for the first time, we're going to need a simpler game.

          We need a super simple game that still allows for wins, losses and draws.
        </p>

          <p>Ladies and gentlemen, for your consideration: Connect2!</p>
        </p>
        <figure id="value-network" style="width:100%;margin:0;background:#000b2a;padding:25px 0;">
          <img style="max-width:300px; display:block; margin:0 auto;" src="connect2.gif" />
        </figure>

        <p>
          In Connect2 players alternate between playing pieces on a tiny <code>1x4</code> board with the goal of placing two of their pieces side-by-side. 
          It's comically easy to win as the first player, but Connect2 still has the interesting property that either player technically has the chance to win, lose or draw. 
          This means we can use it as a test bed to debug and visualize a super-basic implementation of AlphaZero and Monte Carlo Search Trees.
        </p>

        <p>
          Below is the complete game tree of all 53 possible Connect2 states:
        </p>

        <figure id="tree" style="height:600px;width:100%;margin:0;background:#000b2a">
          <svg style="background:#000b2a; margin: 0 auto; display:block; width:1700px; height:500px; padding-top:25px;"></svg>
        </figure>

        <p>
          In total, there are 24 terminal states. From Player 1's perspective there are:
          <ul>
            <li>12 terminal states where we WIN</li>
            <li>8 terminal states where we LOSE</li>
            <li>4 terminal states where we DRAW</li>
          </ul>          
        </p>

        <h4>Representing the Game</h4>
        <p>One drawback of AlphaZero is that we need to be able to perfectly simulate the game we want to play. This ends up being relatively straightforward for Connect2 but 
          is much more difficult for games like chess that have more complex rules. The full code for Connect2 is available <a href="https://github.com/JoshVarty/AlphaZeroSimple/blob/ecf72a468aba26b8b155ec6fb1b91697a2fbb7a9/game.py">on GitHub</a>. It contains logic that defines 
          what moves are valid, how to transition between states and what reward a player should receive.
        </p>
        <p>
          In our implementation we're going to represent a player's own pieces with <code>1</code>, their opponent's pieces with <code>-1</code> and an empty space as <code>0</code>. So the initial starting state looks like <code>[0,0,0,0]</code>. The player who wins the game will receive a reward of <code>1</code> and the player who loses will receive <code>-1</code>. Draws will receive a reward of <code>0</code>.
        </p>
        <p><strong>Note:</strong> There is a very important detail here: The player who is playing always sees <em>their own</em> pieces as <code>1</code>. In our implementation, we simply multiply the board by <code>-1</code> every time we transition between players. Below, observe that state "toggles" as players take turns placing pieces:</p>

        <figure id="treeWithStates" style="height:600px;width:100%;margin:0;background:#000b2a">
          <svg style="background:#000b2a; margin: 0 auto; display:block; width:1700px; height:500px; padding-top:25px;"></svg>
        </figure>
        <hr>

        <h2>Alpha Zero</h2>

        <p>AlphaZero is built from three core pieces:
          <ol>
          <li>Value Network</li>
          <li>Policy Network</li>
          <li>Monte Carlo Tree Search  </li>
          </ol>
        </p>

        <h3>Value Network</h3>

        <p>
          The value network accepts a board state as input and gives us a score as output. If we are going to win with absolute certainty, we want our value network to output <code>1</code>. If we are going to lose, we want our value network to output <code>-1</code>. If we are going to draw, we want our value network to output <code>0</code>.
        </p>

        <p>For example, the game below is guaranteed to be a tie, so we'd like our network to produce 0 (or something close to it).</p>

        <figure id="value-network" style="width:100%;margin:0;background:#000b2a">
            <img style="max-width:700px;display:block;margin:0 auto" src="value_net.png" />
        </figure>

        <p>There are some subtleties here worth discussing. First off, our network isn't doing any "thinking" to produce a value. That is, it's not looking ahead, considering all possible moves or anything like that.
          It's esssentially acting as an image classifier. In fact for 2D games like Go, we would borrow computer vision architectures like ResNet and use them as the backbone for our networks.
        </p>

        <h4>Training</h4>
        <p>
          In order to train this network, we need to record the moves taken by each player during a self-play game. For example, a sample game might look like:

        
        <pre style="margin-left: calc(50% - 984px / 2);width: 648px;">[ 0  0  0  0]   # Player 1 plays in the first position
[-1  0  0  0]   # Player 2 plays in the third position
[ 1  0 -1  0]   # Player 1 plays in the second position
</pre>
        <p>
          After the final move, Player 1 will be declared the winner. We go back through all the states held by Player 1 and mark them with a reward of 
          <code>1</code>. Similarily, we go through all the states held by Player 2 and mark them with a reward of <code>-1</code>. 
          Our recorded states would now look something like:
        </p>
        
        <pre style="margin-left: calc(50% - 984px / 2);width: 648px;">([ 0  0  0  0],  1)   # Player 1 plays in the first position
([-1  0  0  0], -1)   # Player 2 plays in the third position
([ 1  0 -1  0],  1)   # Player 1 plays in the second position
</pre>

        <p>
          We collect this kind of state and reward information across a large number of games. We then use these recordings as a dataset to train our value network. 
          We ask our network how it would have "valued" a given state, and then train it to be closer to the actual value seen 
          (always <code>1</code>,<code>0</code> or <code>-1</code>,) when playing games. The hope is that with enough training, our value network will 
          start to value game states correctly.
        </p>

        <p>
          It's our hope that over a long enough time horizon, our value network will become increasingly good at identifying "good" states. This ends up being important
          as it will help guide our Monte Carlo Tree Search later.
        </p>

        
        <h3>Policy Network</h3>
        <p>
          The policy network accepts a board state as input and gives us a set of probabilities for each move as output. The "better" the move, the higher we would like the probability for the corresponding position.
          The role of the policy network is to "guide" our Monte Carlo Tree search by suggesting promising moves. The Monte Carlo Tree Search takes these suggestions and digs deeper 
          into the games that they would create (more on that later).
        </p>
        <p>We call the suggestions produced by the policy network "priors".</p>
        <p>For example, the game below can be won in a single move, so we'd like our network to confidently suggest that we play in the first position:</p>

        <figure id="value-network" style="width:100%;margin:0;background:#000b2a; padding-top:15px;" >
            <img style="max-width:795px;display:block;margin:0 auto" src="policy_net.png" />
        </figure>

        <p>Note that our network often gives non-zero probabilities to illegal moves. Above, our network gives 0.01 to the second and third slots.
          We actually have to correct for this manually by masking out illegal moves, and then re-normalizing the remaining scores so they still sum to a probability of 1.00.
        </p>
        <p>
          Like the value network, our policy network is not doing any kind of "deep thinking" or lookahead. In fact it's more comparable to something like a human playing bullet chess. 
          It's simply making a snap decision based on the current state of the board. 
        </p>

        <figure id="value-network" style="width:100%;margin:0;background:#000b2a; padding-top:0px;" >
          <img style="display: block; margin:0 auto; max-width:25%;" src="bulletchess.gif" />
        </figure>

        <h4>Training</h4>
        <p>
          One thing I find counter-intuitive about AlphaZero is that we don't directly train our policy network to make "good" moves. 
          Instead we train it to mimic the output of the Monte Carlo Tree Search. As we play games, the policy network suggests moves to Monte Carlo Tree Search. MCTS uses these suggestions (or priors) 
          to explore the game tree and returns a  better set of probabilities for a given state. We record the <strong>state</strong> and the 
          <strong>probabilities produced by the MCTS</strong>. For example, a sample game might look like:

                  <pre style="margin-left: calc(50% - 984px / 2);width: 648px;">([ 0  0  0  0], [0.1, 0.4, 0.4, 0.1])
([-1  0  0  0], [0.0, 0.3, 0.3, 0.3])
([ 1  0 -1  0], [0.0, 0.8, 0.0, 0.2])
</pre>

        <p>
          Once again, we collect this information over a large number of games. We use these recordings as a dataset to train our policy network. We ask our policy network 
          what prior probabilities it would recommend for a given state. We then use Cross Entropy Loss to try and match the policy network's priors to the probabilities recommended by the MCTS. 
        </p>


        <h3>Monte Carlo Tree Search</h3>

        <p>Despite the world's focus on the neural networks involved in AlphaZero, the true magic of AlphaZero actually comes from 
          Monte Carlo Tree Search. It's here that AlphaZero simulates moves and looks ahead to explore a range of promising moves.
        </p>

        <p>The search tree we're using is the same as the ones shown above. Each node represents a reachable board state and the edges represent actions that 
          a player can take in that state. Each node stores a few pieces of information on it:
        </p>

        <dt-code block language="python">
class Node:
  def __init__(self, prior, to_play):
      self.visit_count = 0    # Number of times this state was visited during MCTS. "Good" are visited more then "bad" states.
      self.to_play = to_play  # The player whose turn it is. (1 or -1)
      self.prior = prior      # The prior probability of selecting this state from its parent
      self.value_sum = 0      # The total value of this state from all visits
      self.children = {}      # A lookup of legal child positions
      self.state = None       # The board state as this node
        </dt-code>
        <p>
          Monte Carlo Tree Search is comprised of running three stages multiple times. These stages are:
          <ol>
            <li>Select</li>
            <li>Expand</li>
            <li>Backup</li>
          </ol>
        </p>

        <p>Before we try to understand each stage, let's watch Monte Carlo Tree search to try to get a feel for how it all works.</p>


<figure style="background: #1e1e1e;margin:0;width:100%;color:#dfdfdf">
<div style="max-width: 1000px;margin:0 auto; font-size:0.85rem;line-height: 1.3rem;">
<pre style="margin:0;padding:10px 0;"><span id="line0"><span class="keyword">def</span> <span class="secondary-keyword">run</span>(<span class="args">self</span>, <span class="args">state</span>, <span class="args">to_play</span>, <span class="args">num_simulations</span>):</span>
    <span id="line1">root = Node(0, to_play)</span>                                                       <span id="line1-info" class="variable-info"></span>
    <span id="line2"class="comment"># EXPAND root</span>
    <span id="line3">root.expand(<span class="keyword">self</span>.model, <span class="keyword">self</span>.game, state, to_play)</span>

    <span id="line4"><span class="control-flow">for</span> _ <span class="keyword">in</span> <span class="secondary-keyword">range</span>(num_simulations):</span>
        <span id="line5">node = root</span>                                                               <span id="line5-info" class="variable-info"></span>
        <span id="line6">search_path = [node]</span>                                                      <span id="line6-info" class="variable-info"></span>
        <span id="line7" class="comment"># SELECT</span>
        <span id="line8"><span class="control-flow">while</span> node.expanded():</span>
            <span id="line9">action, node = node.select_child()</span>                                    <span id="line9-info" class="variable-info"></span>
            <span id="line10">search_path.append(node)</span>

        <span id="line11">parent = search_path[-2]</span>                                                  <span id="line11-info" class="variable-info"></span>
        <span id="line12">state = parent.state</span>                                                      <span id="line12-info" class="variable-info"></span>
        <span id="line13">next_state, _ = <span class="keyword">self</span>.game.get_next_state(state, <span class="args">to_play</span>=1, <span class="args">action</span>=action)</span> <span id="line13-info" class="variable-info"></span>
        <span id="line14">next_state = <span class="keyword">self</span>.game.get_canonical_board(next_state, <span class="args">player</span>=-1)</span>         <span id="line14-info" class="variable-info"></span>
        <span id="line15">value = <span class="keyword">self</span>.game.get_reward_for_player(next_state, <span class="args">player</span>=1)</span></span>             <span id="line15-info" class="variable-info"></span>
        <span id="line16"><span class="control-flow">if</span> value is None:</span>
            <span id="line17" class="comment"># EXPAND</span>
            <span id="line18">value = node.expand(<span class="keyword">self</span>.model, <span class="keyword">self</span>.game, next_state, parent.to_play * -1)</span>  <span id="line18-info" class="variable-info"></span>

        <span id="line19"><span class="keyword">self</span>.backup(search_path, value, parent.to_play * -1)</span>

    <span id="line20"><span class="keyword">return</span> root</span></pre>
    <div class="controls-container">
      <button class="back" onclick="goBack('mcts')" title="Back"></button>
      <button class="play" onclick="play('mcts')" title="Play"></button>
      <button class="stop" onclick="pause('mcts')" title="Stop"></button>
      <button class="forward" onclick="clearAndGoForward('mcts')" title="Next"></button>
  </div>
  </div>
</figure>

        <figure id="mcts-demo" style="height:600px;width:100%;margin:0;background:#000b2a">
          <svg style="background:#000b2a; margin: 0 auto; display:block; width:1750px; height:500px; padding-top:25px;"></svg>
        </figure>
      </dt-article>

      
      <dt-appendix>
      </dt-appendix>
      
      <script type="text/bibliography">
        @article{gregor2015draw,
          title={DRAW: A recurrent neural network for image generation},
          author={Gregor, Karol and Danihelka, Ivo and Graves, Alex and Rezende, Danilo Jimenez and Wierstra, Daan},
          journal={arXivreprint arXiv:1502.04623},
          year={2015},
          url={https://arxiv.org/pdf/1502.04623.pdf}
        }
      </script>

    <script src="https://distill.pub/template.v1.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
      class Node {
        constructor(x, y, state, parent, toPlay, stats, highlight) {
          this.x = x;
          this.y = y;
          this.state = state;
          this.parent = parent
          this.children = []
          this.toPlay = toPlay
          this.stats = stats
          this.highlight = highlight

          if (this.parent != null) {
            this.parent.children.push(this);
          }
        }
      }


      let state = -1;
      let MAX_STATE_NUMBER = 81;
      let boardHeight = 15;
      let boardWidth = 63;
      let interactiveRoot = new Node(860-32, 30, null, null, 1, {v : 0, n: 0, p: "None"})

      function goState0(containerId) {
        let showStates = true;

        interactiveRoot = new Node(860-32, 30, null, null, 1, {v : 0, n: 0, p: "None"})
        let element = document.getElementById('line1-info');
        element.style.display = "inline"
        element.innerText = "(State: None)"
      }

      function goState1(containerId) {
        let showStates = true;

        interactiveRoot = new Node(860-32, 30, [0,0,0,0], null, 1, {v : 0, n: 0, p: "None"}) 

        let element = document.getElementById('line1-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
        
        let highlight = true;
        let r1c1 = new Node(2*1700/12/2, 125, null, interactiveRoot, -1, {p: 0.25, v:0, n:0}, highlight)
        let r1c2 = new Node(9*1700/12/2, 125, null, interactiveRoot, -1, {p: 0.25, v:0, n:0}, highlight)
        let r1c3 = new Node(14*1700/12/2, 125, null, interactiveRoot, -1, {p: 0.25, v:0, n:0}, highlight)
        let r1c4 = new Node(21*1700/12/2, 125, null, interactiveRoot, -1, {p: 0.25, v:0, n:0}, highlight)
      }

      function goState2(containerId) {
        goState1(containerId);

        interactiveRoot.children[0].highlight = false
        interactiveRoot.children[1].highlight = false
        interactiveRoot.children[2].highlight = false
        interactiveRoot.children[3].highlight = false

        let element = document.getElementById('line5-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }
      
      function goState3(containerId) {

        goState2(containerId);
        
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]) ]"
      }

      function goState4(containerId) {
        goState3(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: None)"
      }

      function goState5(containerId) {
        goState4(containerId);
        
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: None) ]"
      }

      function goState6(containerId) {
        goState5(containerId);
        
        let element = document.getElementById('line11-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState7(containerId) {
        goState6(containerId);
        
        let element = document.getElementById('line12-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,0]"
      }

      function goState8(containerId) {
        goState7(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[1,0,0,0]"
      }

      function goState9(containerId) {
        goState8(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[-1,0,0,0]"
        element = document.getElementById('line14-info');
        element.style.display = "inline"
        element.innerText = "[-1,0,0,0]"
      }
      
      function goState10(containerId) {
        goState9(containerId);
        
        let element = document.getElementById('line15-info');
        element.style.display = "inline"
        element.innerText = "None"
      }

      function goState11(containerId) {
        goState10(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [-1,0,0,0])"

        element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [-1,0,0,0]) ]"
        
        element = document.getElementById('line18-info');
        element.style.display = "inline"
        element.innerText = "0.5"

        let r1c1 = interactiveRoot.children[0]
        r1c1.state = [1, 0, 0, 0]
        y = 225
        let highlight = true
        let r2c1 = new Node(1*1700/12/2/2, y, null, r1c1, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c2 = new Node(4*1700/12/2/2, y, null, r1c1, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c3 = new Node(7*1700/12/2/2, y, null, r1c1, 1, {p: 0.33, v:0, n:0}, highlight)
      }

      function goState12(containerId) {
        goState11(containerId);

        interactiveRoot.children[0].children[0].highlight = false
        interactiveRoot.children[0].children[1].highlight = false
        interactiveRoot.children[0].children[2].highlight = false

        interactiveRoot.stats.v = -0.5
        interactiveRoot.stats.n = 1
        interactiveRoot.highlight = true

        let r1c1 = interactiveRoot.children[0]
        r1c1.stats.v = 0.5
        r1c1.stats.n = 1
        r1c1.highlight = true
      }

      function goState13(containerId) {
        goState12(containerId);

        interactiveRoot.highlight = false
        interactiveRoot.children[0].highlight = false

        document.getElementById('line5-info').style.display = "none"
        document.getElementById('line6-info').style.display = "none"
        document.getElementById('line9-info').style.display = "none"
        document.getElementById('line11-info').style.display = "none"
        document.getElementById('line12-info').style.display = "none"
        document.getElementById('line13-info').style.display = "none"
        document.getElementById('line14-info').style.display = "none"
        document.getElementById('line15-info').style.display = "none"
        document.getElementById('line18-info').style.display = "none"
      }

      function goState14(containerId) {
        goState13(containerId);
        let element = document.getElementById('line5-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState15(containerId) {
        goState14(containerId);
                
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]) ]"
      }
      
      function goState16(containerId) {
        goState15(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "1, (State: None)"
      }

      function goState17(containerId) {
        goState16(containerId);

        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: None) ]"
      }

      function goState18(containerId) {
        goState17(containerId);
        let element = document.getElementById('line11-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState19(containerId) {
        goState18(containerId);
        
        let element = document.getElementById('line12-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,0]"
      }

      function goState20(containerId) {
        goState19(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,1,0,0]"
      }
      
      function goState21(containerId) {
        goState20(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,-1,0,0]"
        
        element = document.getElementById('line14-info');
        element.style.display = "inline"
        element.innerText = "[0,-1,0,0]"
      }

      function goState22(containerId) {
        goState21(containerId);

        let element = document.getElementById('line15-info');
        element.style.display = "inline"
        element.innerText = "None"
      }

      function goState23(containerId) {
        goState22(containerId);

        
        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [0,-1,0,0])"

        element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [0,-1,0,0]) ]"
        
        element = document.getElementById('line18-info');
        element.style.display = "inline"
        element.innerText = "0.5"

        let r1c2 = interactiveRoot.children[1]
        r1c2.state = [0, 1, 0, 0]
        y = 225
        let highlight = true
        let r2c4 = new Node(14*1700/12/2/2, y, null, r1c2, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c5 = new Node(17*1700/12/2/2, y, null, r1c2, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c6 = new Node(20*1700/12/2/2, y, null, r1c2, 1, {p: 0.33, v:0, n:0}, highlight)
      }

      function goState24(containerId) {
        goState23(containerId);

        interactiveRoot.children[1].children[0].highlight = false;
        interactiveRoot.children[1].children[1].highlight = false;
        interactiveRoot.children[1].children[2].highlight = false;

        interactiveRoot.stats.v = -0.5
        interactiveRoot.stats.n = 2
        interactiveRoot.highlight = true

        let r1c2 = interactiveRoot.children[1]
        r1c2.stats.v = 0.5
        r1c2.stats.n = 1
        r1c2.highlight = true
      }
      
      function goState25(containerId) {
        goState24(containerId);

        interactiveRoot.highlight = false
        interactiveRoot.children[1].highlight = false
        
        document.getElementById('line5-info').style.display = "none"
        document.getElementById('line6-info').style.display = "none"
        document.getElementById('line9-info').style.display = "none"
        document.getElementById('line11-info').style.display = "none"
        document.getElementById('line12-info').style.display = "none"
        document.getElementById('line13-info').style.display = "none"
        document.getElementById('line14-info').style.display = "none"
        document.getElementById('line15-info').style.display = "none"
        document.getElementById('line18-info').style.display = "none"
      }

      function goState26(containerId) {
        goState25(containerId);
        let element = document.getElementById('line5-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState27(containerId) {
        goState26(containerId);
                
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]) ]"
      }
      
      function goState28(containerId) {
        goState27(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "2, (State: None)"
      }

      function goState29(containerId) {
        goState28(containerId); 
        
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: None) ]"
      }

        function goState30(containerId) {
        goState29(containerId);
        let element = document.getElementById('line11-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState31(containerId) {
        goState30(containerId);
        
        let element = document.getElementById('line12-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,0]"
      }

      function goState32(containerId) {
        goState31(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,0,1,0]"
      }
      
      function goState33(containerId) {
        goState32(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,0,-1,0]"
        
        element = document.getElementById('line14-info');
        element.style.display = "inline"
        element.innerText = "[0,0,-1,0]"
      }
     
      function goState34(containerId) {
        goState33(containerId);

        let element = document.getElementById('line15-info');
        element.style.display = "inline"
        element.innerText = "None"
      }

      function goState35(containerId) {
        goState34(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [0,0,-1,0])"

        element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [0,0,-1,0]) ]"
        
        element = document.getElementById('line18-info');
        element.style.display = "inline"
        element.innerText = "0.5"

        let r1c3 = interactiveRoot.children[2]
        r1c3.state = [0, 0, 1, 0]
        let y = 225
        let highlight = true
        let r2c7 = new Node(26*1700/12/2/2, y, null, r1c3, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c8 = new Node(29*1700/12/2/2, y, null, r1c3, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c9 = new Node(32*1700/12/2/2, y, null, r1c3, 1, {p: 0.33, v:0, n:0}, highlight)
      }

      function goState36(containerId) {
        goState35(containerId);

        interactiveRoot.children[2].children[0].highlight = false
        interactiveRoot.children[2].children[1].highlight = false
        interactiveRoot.children[2].children[2].highlight = false

        interactiveRoot.stats.v = -0.5
        interactiveRoot.stats.n = 3
        interactiveRoot.highlight = true

        let r1c3 = interactiveRoot.children[2]
        r1c3.stats.v = 0.5
        r1c3.stats.n = 1
        r1c3.highlight = true
      }

      function goState37(containerId) {
        goState36(containerId);

        interactiveRoot.highlight = false
        interactiveRoot.children[2].highlight = false

        
        document.getElementById('line5-info').style.display = "none"
        document.getElementById('line6-info').style.display = "none"
        document.getElementById('line9-info').style.display = "none"
        document.getElementById('line11-info').style.display = "none"
        document.getElementById('line12-info').style.display = "none"
        document.getElementById('line13-info').style.display = "none"
        document.getElementById('line14-info').style.display = "none"
        document.getElementById('line15-info').style.display = "none"
        document.getElementById('line18-info').style.display = "none"
      }

      function goState38(containerId) {
        goState37(containerId);
        let element = document.getElementById('line5-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState39(containerId) {
        goState38(containerId);
                
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]) ]"
      }
      
      function goState40(containerId) {
        goState39(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "3, (State: None)"
      }
      
      function goState41(containerId) {
        goState40(containerId);

        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: None) ]"
      }
      
      function goState42(containerId) {
        goState41(containerId);

        let element = document.getElementById('line11-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState43(containerId) {
        goState42(containerId);

        let element = document.getElementById('line12-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,0]"
      }

      function goState44(containerId) {
        goState43(containerId)

        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,1]"
      }
      
      function goState45(containerId) {
        goState44(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,-1]"
        
        element = document.getElementById('line14-info');
        element.style.display = "inline"
        element.innerText = "[0,0,0,-1]"
      }

      function goState46(containerId) {
        goState45(containerId);
        
        let element = document.getElementById('line15-info');
        element.style.display = "inline"
        element.innerText = "None"
      }

      function goState47(containerId) {
        goState46(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [0,0,0,-1])"

        element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [0,0,0,-1]) ]"
        
        element = document.getElementById('line18-info');
        element.style.display = "inline"
        element.innerText = "0.5"

        let r1c4 = interactiveRoot.children[3]
        r1c4.state = [0, 0, 0, 1]
        let y = 225
        let highlight = true
        let r2c10 = new Node(39*1700/12/2/2, y, null, r1c4, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c11 = new Node(42*1700/12/2/2, y, null, r1c4, 1, {p: 0.33, v:0, n:0}, highlight)
        let r2c12 = new Node(45*1700/12/2/2, y, null, r1c4, 1, {p: 0.33, v:0, n:0}, highlight)
      }

      function goState48(containerId) {
        goState47(containerId);

        interactiveRoot.children[3].children[0].highlight = false
        interactiveRoot.children[3].children[1].highlight = false
        interactiveRoot.children[3].children[2].highlight = false

        interactiveRoot.stats.v = -0.5
        interactiveRoot.stats.n = 4
        interactiveRoot.highlight = true

        let r1c3 = interactiveRoot.children[3]
        r1c3.stats.v = 0.5
        r1c3.stats.n = 1
        r1c3.highlight = true
      }

      function goState49(containerId) {
        goState48(containerId);

        interactiveRoot.highlight = false
        interactiveRoot.children[3].highlight = false
           
        document.getElementById('line5-info').style.display = "none"
        document.getElementById('line6-info').style.display = "none"
        document.getElementById('line9-info').style.display = "none"
        document.getElementById('line11-info').style.display = "none"
        document.getElementById('line12-info').style.display = "none"
        document.getElementById('line13-info').style.display = "none"
        document.getElementById('line14-info').style.display = "none"
        document.getElementById('line15-info').style.display = "none"
        document.getElementById('line18-info').style.display = "none"
      }

      function goState50(containerId) {
        goState49(containerId);
        let element = document.getElementById('line5-info');
        element.style.display = "inline"
        element.innerText = "(State: [0,0,0,0])"
      }

      function goState51(containerId) {
        goState50(containerId);
                
        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]) ]"
      }
      
      function goState52(containerId) {
        goState51(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [-1,0,0,0])"
      }

      function goState53(containerId) {
        goState52(containerId);

        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [-1,0,0,0]) ]"
      }

      function goState54(containerId) {
        goState53(containerId);

        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "1, (State: None)"
      }

      function goState55(containerId) {
        goState54(containerId);

        let element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [-1,0,0,0]), (State: None) ]";
      }

      function goState56(containerId) {
        goState55(containerId);

        let element = document.getElementById('line11-info');
        element.style.display = "inline"
        element.innerText = "(State: [-1,0,0,0])"
      }

      function goState57(containerId) {
        goState56(containerId);
        
        let element = document.getElementById('line12-info');
        element.style.display = "inline"
        element.innerText = "[-1,0,0,0]"
      }

      function goState58(containerId) {
        goState57(containerId)

        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[-1,1,0,0]"
      }
      
      function goState59(containerId) {
        goState58(containerId);
        
        let element = document.getElementById('line13-info');
        element.style.display = "inline"
        element.innerText = "[1,-1,0,0]"
        
        element = document.getElementById('line14-info');
        element.style.display = "inline"
        element.innerText = "[1,-1,0,0]"
      }

      function goState60(containerId) {
        goState59(containerId);
        
        let element = document.getElementById('line15-info');
        element.style.display = "inline"
        element.innerText = "None"
      }

      function goState61(containerId) {
        goState59(containerId);
        
        let element = document.getElementById('line9-info');
        element.style.display = "inline"
        element.innerText = "0, (State: [0,0,0,-1])"

        element = document.getElementById('line6-info');
        element.style.display = "inline"
        element.innerText = "[ (State: [0,0,0,0]), (State: [0,0,0,-1]) ]"
        
        element = document.getElementById('line18-info');
        element.style.display = "inline"
        element.innerText = "0.5"

        let r2c1 = interactiveRoot.children[0].children[0]
        r2c1.state = [1, -1, 0, 0]
        let y = 325
        let highlight = true
        let r3c1 = new Node(0*1700/12/2/2, y, null, r2c1, 1, {p: 0.5, v:0, n:0}, highlight)
        let r3c2 = new Node(4*1700/12/2/2, y, null, r2c1, 1, {p: 0.5, v:0, n:0}, highlight)
      }

      function goState62(containerId) {
        goState61(containerId)

        interactiveRoot.children[0].children[0].children[0].highlight = false
        interactiveRoot.children[0].children[0].children[1].highlight = false

        interactiveRoot.stats.v = -0.3
        interactiveRoot.stats.n = 5
        interactiveRoot.highlight = true

        let r2c1 = interactiveRoot.children[0]
        r2c1.stats.v = 0
        r2c1.stats.n = 2
        r2c1.highlight = true

        let r3c1 = interactiveRoot.children[0].children[0]
        r3c1.stats.v = 0.5
        r3c1.stats.n = 1
        r3c1.highlight = true;
      }
      
      function goState63(containerId) {
        goState62(containerId)

        interactiveRoot.highlight = false
        interactiveRoot.children[0].highlight = false
        interactiveRoot.children[0].children[0].highlight = false

        document.getElementById('line5-info').style.display = "none"
        document.getElementById('line6-info').style.display = "none"
        document.getElementById('line9-info').style.display = "none"
        document.getElementById('line11-info').style.display = "none"
        document.getElementById('line12-info').style.display = "none"
        document.getElementById('line13-info').style.display = "none"
        document.getElementById('line14-info').style.display = "none"
        document.getElementById('line15-info').style.display = "none"
        document.getElementById('line18-info').style.display = "none"
      }

      function goToState(stateNumber) {

        let containerId = '#mcts-demo svg'

         var container = d3.select(containerId)
            container.selectAll("*").remove()

        let activeLines = document.getElementsByClassName("active-line");
        for (var i = 0; i < activeLines.length; i++) {
          let currentActiveLine = activeLines[i];
          currentActiveLine.classList.remove('active-line')
        }

        let variableInfo = document.getElementsByClassName("variable-info")
        for (var i = 0; i < variableInfo.length; i++) {
          let currentInfo = variableInfo[i];
          currentInfo.style.display = "None"
        }
        
        console.log(state)
        if (state == 0) {
            var activeLine = document.getElementById("line1")
            activeLine.setAttribute('class', 'active-line')
            goState0(containerId)
        }
        else if(state == 1) {
            var activeLine = document.getElementById("line3")
            activeLine.setAttribute('class', 'active-line')
            goState1(containerId)
        }
        else if(state == 2) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState1(containerId)
            
            interactiveRoot.children[0].highlight = false
            interactiveRoot.children[1].highlight = false
            interactiveRoot.children[2].highlight = false
            interactiveRoot.children[3].highlight = false
        }
        else if(state == 3) {
            var activeLine = document.getElementById("line5")
            activeLine.setAttribute('class', 'active-line')
            goState2(containerId)
        }
        else if(state == 4) {
            var activeLine = document.getElementById("line6")
            activeLine.setAttribute('class', 'active-line')
            goState3(containerId)
        }
        else if(state == 5) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState3(containerId)
        }
        else if(state == 6) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState4(containerId)
        }
        else if(state == 7) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState5(containerId)
        }
        else if(state == 8) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState5(containerId)
        }
        else if(state == 9) {
            var activeLine = document.getElementById("line11")
            activeLine.setAttribute('class', 'active-line')
            goState6(containerId)
        }
        else if(state == 10) {
            var activeLine = document.getElementById("line12")
            activeLine.setAttribute('class', 'active-line')
            goState7(containerId)
        }
        else if(state == 11) {
            var activeLine = document.getElementById("line13")
            activeLine.setAttribute('class', 'active-line')
            goState8(containerId)
        }
        else if(state == 12) {
            var activeLine = document.getElementById("line14")
            activeLine.setAttribute('class', 'active-line')
            goState9(containerId)
        }
        else if(state == 13) {
            var activeLine = document.getElementById("line15")
            activeLine.setAttribute('class', 'active-line')
            goState10(containerId)
        }
        else if(state == 14) {
            var activeLine = document.getElementById("line16")
            activeLine.setAttribute('class', 'active-line')
            goState10(containerId)
        }
        else if(state == 15) {
            var activeLine = document.getElementById("line18")
            activeLine.setAttribute('class', 'active-line')
            goState11(containerId)
        }
        else if(state == 16) {
            var activeLine = document.getElementById("line19")
            activeLine.setAttribute('class', 'active-line')
            goState12(containerId)
        }
        else if(state == 17) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState13(containerId)
        }
        else if(state == 18) {
            var activeLine = document.getElementById("line5")
            activeLine.setAttribute('class', 'active-line')
            goState14(containerId)
        }
        else if(state == 19) {
            var activeLine = document.getElementById("line6")
            activeLine.setAttribute('class', 'active-line')
            goState15(containerId)
        }
        else if(state == 20) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState15(containerId)
        }
        else if(state == 21) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState16(containerId)
        }
        else if(state == 22) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState17(containerId)
        }
        else if(state == 23) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState17(containerId)
        }
        else if(state == 24) {
            var activeLine = document.getElementById("line11")
            activeLine.setAttribute('class', 'active-line')
            goState18(containerId)
        }
        else if(state == 25) {
            var activeLine = document.getElementById("line12")
            activeLine.setAttribute('class', 'active-line')
            goState19(containerId)
        }
        else if(state == 26) {
            var activeLine = document.getElementById("line13")
            activeLine.setAttribute('class', 'active-line')
            goState20(containerId)
        }
        else if(state == 27) {
            var activeLine = document.getElementById("line14")
            activeLine.setAttribute('class', 'active-line')
            goState21(containerId)
        }
        else if(state == 28) {
            var activeLine = document.getElementById("line15")
            activeLine.setAttribute('class', 'active-line')
            goState22(containerId)
        }
        else if(state == 29) {
            var activeLine = document.getElementById("line16")
            activeLine.setAttribute('class', 'active-line')
            goState22(containerId)
        }
        else if(state == 30) {
            var activeLine = document.getElementById("line18")
            activeLine.setAttribute('class', 'active-line')
            goState23(containerId)
        }
        else if(state == 31) {
            var activeLine = document.getElementById("line19")
            activeLine.setAttribute('class', 'active-line')
            goState24(containerId)
        }
        else if(state == 32) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState25(containerId)
        }
        else if(state == 33) {
            var activeLine = document.getElementById("line5")
            activeLine.setAttribute('class', 'active-line')
            goState26(containerId)
        }
        else if(state == 34) {
            var activeLine = document.getElementById("line6")
            activeLine.setAttribute('class', 'active-line')
            goState27(containerId)
        }
        else if(state == 35) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState27(containerId)
        }
        else if(state == 36) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState28(containerId)
        }
        else if(state == 37) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState29(containerId)
        }
        else if(state == 38) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState30(containerId)
        }
        else if(state == 39) {
            var activeLine = document.getElementById("line11")
            activeLine.setAttribute('class', 'active-line')
            goState30(containerId)
        }
        else if(state == 40) {
            var activeLine = document.getElementById("line12")
            activeLine.setAttribute('class', 'active-line')
            goState31(containerId)
        }
        else if(state == 41) {
            var activeLine = document.getElementById("line13")
            activeLine.setAttribute('class', 'active-line')
            goState32(containerId)
        }
        else if(state == 42) {
            var activeLine = document.getElementById("line14")
            activeLine.setAttribute('class', 'active-line')
            goState33(containerId)
        }
        else if(state == 43) {
            var activeLine = document.getElementById("line15")
            activeLine.setAttribute('class', 'active-line')
            goState34(containerId)
        }
        else if(state == 44) {
            var activeLine = document.getElementById("line16")
            activeLine.setAttribute('class', 'active-line')
            goState34(containerId)
        }
        else if(state == 45) {
            var activeLine = document.getElementById("line18")
            activeLine.setAttribute('class', 'active-line')
            goState35(containerId)
        }
        else if(state == 46) {
            var activeLine = document.getElementById("line19")
            activeLine.setAttribute('class', 'active-line')
            goState36(containerId)
        }
        else if(state == 47) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState37(containerId)
        }
        else if(state == 48) {
            var activeLine = document.getElementById("line5")
            activeLine.setAttribute('class', 'active-line')
            goState38(containerId)
        }
        else if(state == 49) {
            var activeLine = document.getElementById("line6")
            activeLine.setAttribute('class', 'active-line')
            goState39(containerId)
        }
        else if(state == 50) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState39(containerId);
        }
        else if(state == 51) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState40(containerId)
        }
        else if(state == 52) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState41(containerId)
        }
        else if(state == 53) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState41(containerId)
        }
        else if(state == 54) {
            var activeLine = document.getElementById("line11")
            activeLine.setAttribute('class', 'active-line')
            goState42(containerId)
        }
        else if(state == 55) {
            var activeLine = document.getElementById("line12")
            activeLine.setAttribute('class', 'active-line')
            goState43(containerId)
        }
        else if(state == 56) {
            var activeLine = document.getElementById("line13")
            activeLine.setAttribute('class', 'active-line')
            goState44(containerId)
        }
        else if(state == 57) {
            var activeLine = document.getElementById("line14")
            activeLine.setAttribute('class', 'active-line')
            goState45(containerId)
        }
        else if(state == 58) {
            var activeLine = document.getElementById("line15")
            activeLine.setAttribute('class', 'active-line')
            goState46(containerId)
        }
        else if(state == 59) {
            var activeLine = document.getElementById("line16")
            activeLine.setAttribute('class', 'active-line')
            goState46(containerId)
        }
        else if(state == 60) {
            var activeLine = document.getElementById("line18")
            activeLine.setAttribute('class', 'active-line')
            goState47(containerId)
        }
        else if(state == 61) {
            var activeLine = document.getElementById("line19")
            activeLine.setAttribute('class', 'active-line')
            goState48(containerId)
        }
        else if(state == 62) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState49(containerId)
        }
        else if(state == 63) {
            var activeLine = document.getElementById("line5")
            activeLine.setAttribute('class', 'active-line')
            goState50(containerId)
        }
        else if(state == 64) {
            var activeLine = document.getElementById("line6")
            activeLine.setAttribute('class', 'active-line')
            goState51(containerId)
        }
        else if(state == 65) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState51(containerId)
        }
        else if(state == 66) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState52(containerId)
        }
        else if(state == 67) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState53(containerId)
        }
        else if(state == 68) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState53(containerId)
        }
        else if(state == 69) {
            var activeLine = document.getElementById("line9")
            activeLine.setAttribute('class', 'active-line')
            goState54(containerId)
        }
        else if(state == 70) {
            var activeLine = document.getElementById("line10")
            activeLine.setAttribute('class', 'active-line')
            goState55(containerId)
        }
        else if(state == 71) {
            var activeLine = document.getElementById("line8")
            activeLine.setAttribute('class', 'active-line')
            goState55(containerId)
        }
        else if(state == 72) {
            var activeLine = document.getElementById("line11")
            activeLine.setAttribute('class', 'active-line')
            goState56(containerId)
        }
        else if(state == 73) {
            var activeLine = document.getElementById("line12")
            activeLine.setAttribute('class', 'active-line')
            goState57(containerId)
        }
        else if(state == 74) {
            var activeLine = document.getElementById("line13")
            activeLine.setAttribute('class', 'active-line')
            goState58(containerId)
        }
        else if(state == 75) {
            var activeLine = document.getElementById("line14")
            activeLine.setAttribute('class', 'active-line')
            goState59(containerId)
        }
        else if(state == 76) {
            var activeLine = document.getElementById("line15")
            activeLine.setAttribute('class', 'active-line')
            goState60(containerId)
        }
        else if(state == 77) {
            var activeLine = document.getElementById("line16")
            activeLine.setAttribute('class', 'active-line')
            goState60(containerId)
        }
        else if(state == 78) {
            var activeLine = document.getElementById("line18")
            activeLine.setAttribute('class', 'active-line')
            goState61(containerId)
        }
        else if(state == 79) {
            var activeLine = document.getElementById("line19")
            activeLine.setAttribute('class', 'active-line')
            goState62(containerId)
        }
        else if(state == 80) {
            var activeLine = document.getElementById("line4")
            activeLine.setAttribute('class', 'active-line')
            goState63(containerId)
        }
        else if(state == 81) {
            var activeLine = document.getElementById("line20")
            activeLine.setAttribute('class', 'active-line')
            goState63(containerId)
        }


        let showStates = true;
        placeTree(containerId, interactiveRoot, showStates)
        placeEdges(containerId, interactiveRoot, showStates)
      }

      function goBack(figureName) {
        state = Math.max(state - 1, 0);
        goToState(state);
      }

      function clearAndGoForward(figureName) {
        state = Math.min(state + 1, MAX_STATE_NUMBER);
        goToState(state);
      }


       const kPath = `M78.3,96.5c-0.1,0.4-0.5,0.6-1.1,0.6H64.9c-0.7,0-1.4-0.3-1.9-1l-20.3-26L37,75.5v20.1 c0,0.9-0.5,1.4-1.4,1.4H26c-0.9,0-1.4-0.5-1.4-1.4V3.9c0-0.9,0.5-1.4,1.4-1.4h9.5C36.5,2.5,37,3,37,3.9v56.5l24.3-24.7 c0.6-0.6,1.3-1,1.9-1H76c0.6,0,0.9,0.2,1.1,0.7c0.2,0.6,0.1,1-0.1,1.2l-25.7,25L78,95.1C78.4,95.5,78.5,95.9,78.3,96.5z`;
       const goose1Path = `M8.8,92.7c-4-18.5,4.7-37.2,20.7-46.2c0,0,2.7-1.4,3.4-1.9c2.2-1.6,3-2.1,3-5c0-5-2.1-7.2-2.1-7.2 c-3.9-3.3-6.3-8.2-6.3-13.7c0-10,8.1-18.1,18.1-18.1s18.1,8.1,18.1,18.1c0,6-1.5,32.7-2.3,38.8l-0.1,1`;
       const goose2Path = `M27.4,19L8.2,27.6c0,0-7.3,2.9,2.6,5c6.1,1.3,24,5.9,24,5.9l1,0.3`;
       const goose3Path =  `M63.7,99.6C52.3,99.6,43,90.3,43,78.9s9.3-20.7,20.7-20.7c10.6,0,34.4,0.1,35.8,9`;

      function placeTree(containerId, node, showStates) {
          placeBoard(containerId, node, boardHeight, boardWidth, showStates)

         for (var i = 0; i < node.children.length; i++) {
          //Recursively place nodes
          placeTree(containerId, node.children[i], showStates);
        }
      }

      function placeEdges(containerId, node) {

        for (var i = 0; i < node.children.length; i++) {

          //Recursively place edges
          placeEdges(containerId, node.children[i]);

          //Draw edge for this child
          let x1 = node.x + 32
          let y1 = node.y + 25
          let x2 = node.children[i].x + 32
          let y2 = node.children[i].y - 15

          placeLine(containerId, x1, y1, x2, y2);
        }
      }

      function placeEmptySlot(container, x, y) {

        container
          .append('svg')
          .attr('x', x)
          .attr('y', y)
          .append('circle')
          .attr('cx', 80)
          .attr('cy', 80)
          .attr('r', 75)
          .attr('fill', 'rgba(0, 255, 255, 0)')
          .attr('stroke', '#0358a4')
          .attr('stroke-width', '13')
      }

      function placeGoosePiece(container, x, y) {
        let svg = container
            .append('svg')
            .attr('x', x)
            .attr('y', y)


        // outer circle
        svg.append('circle')
            .attr('cx', 80)
            .attr('cy', 80)
            .attr('r', 75)
            .attr('fill', 'rgba(255, 255, 255, 0.5)')
            .attr('stroke', 'rgba(255, 255, 255, 0.5)')
            .attr('stroke-width', '3')
        
        // inner circle
        svg.append('circle')
            .attr('cx', 80)
            .attr('cy', 80)
            .attr('r', 60)
            .attr('fill', 'none')
            .attr('stroke', 'rgba(255, 255, 255, 0.5)')
            .attr('stroke-width', '2')

        // goose
        var goose = svg.append('svg').attr('stroke', 'black').attr('fill', 'rgba(0,0,0,0)');
        goose.append('path')
          .attr('d', goose1Path)
          .attr('stroke', 'rgba(255, 255, 255, 1)')
          .attr('stroke-width', '2')
        goose.append('path')
          .attr('d', goose2Path)
          .attr('stroke', 'rgba(255, 255, 255, 1)')
          .attr('stroke-width', '2')
        goose.append('path')
          .attr('d', goose3Path)
          .attr('stroke', 'rgba(255, 255, 255, 1)')
          .attr('stroke-width', '2')
        goose.attr('x', '35')
        goose.attr('y', '35') 
      }

      function placeKagglePiece(container, x, y) {
        // Build the kaggle game piece logo and place inside SVG

        let svg = container
          .append('svg')
          .attr('x', x)
          .attr('y', y)

        // outer circle
        svg.append('circle')
            .attr('cx', 80)
            .attr('cy', 80)
            .attr('r', 75)
            .attr('fill', 'rgba(0, 255, 255, 0.5)')
            .attr('stroke', 'rgba(0, 255, 255, 0.5)')
            .attr('stroke-width', '3')

        // inner circle
        // outer circle
        svg.append('circle')
            .attr('cx', 80)
            .attr('cy', 80)
            .attr('r', 60)
            .attr('fill', 'none')
            .attr('stroke', 'rgba(0, 255, 255, 0.5)')
            .attr('stroke-width', '2')

        // kaggle logo
        var kaggle = svg.append('svg')
            .attr('stroke', 'black')
            .attr('fill', 'rgba(0,0,0,0)')
            .attr('viewBox', '0 0 100 100')
            .attr('height', '80')
            .attr('width', '80')

        kaggle.append('path')
            .attr('d', kPath)
            .attr('stroke', 'rgba(0, 255, 255, 1)')
            .attr('stroke-width', '2')
            .attr('scale', '0.6')
        kaggle.attr('x', '40')
        kaggle.attr('y', '40') 
      }

      function placeLine(containerId, x1, y1, x2, y2) {
        let container = d3.select(containerId)
          .append('line')
          .attr('x1', x1)
          .attr('y1', y1)
          .attr('x2', x2)
          .attr('y2', y2)
          .attr('stroke', 'rgba(255, 255, 255, 0.5')
      }


      function placeBoard(containerId, node, height, width, showStates) {

        let container = d3.select(containerId)
        .append('g')

        let margin = 10

        let svg = container
          .append('svg')
          .attr('height', height)
          .attr('width', width)
          .attr('viewBox', "0 0 672 160")
          .attr('style', 'background:#000b2a')
          .attr('x', node.x)
          .attr('y', node.y)

          if (node.stats !== undefined) {
            let fill = "white"
            if (node.highlight) {
              fill = "red"
            }
            //Show stats
            let text = ""
            let x = node.x + 65
            let y = node.y - 20
            text = "Prior: " + node.stats.p;
            container.append("text")
              .attr('font-family', 'Arial,"Helvetica Neue",Helvetica,sans-serif')
              .attr('font-size', '0.6rem')
              .attr('x', x)
              .attr('y', y)
              .attr('fill', fill)
              .text(text)

            y = node.y - 5
            text = "Value: " + node.stats.v;
            
            container.append("text")
              .attr('font-family', 'Arial,"Helvetica Neue",Helvetica,sans-serif')
              .attr('font-size', '0.6rem')
              .attr('x', x)
              .attr('y', y)
              .attr('fill', fill)
              .text(text)
            
            y = node.y + 10
            text = "Visit Count: " + node.stats.n;
            
            container.append("text")
              .attr('font-family', 'Arial,"Helvetica Neue",Helvetica,sans-serif')
              .attr('font-size', '0.6rem')
              .attr('x', x)
              .attr('y', y)
              .attr('fill', fill)
              .text(text)

          }

          if (showStates) {

            let text = ""
            let x = node.x + 6
            let y = node.y - 4

            if (node.state === null) {
              x = node.x + 16
              text = "None"
            }
            else {
              text = "["
              for(var i = 0; i < node.state.length; i++) {
                text = text + " " + node.state[i] * node.toPlay;
              }
              text = text + "]";


            }

            container.append("text")
            .attr('font-family', 'Arial,"Helvetica Neue",Helvetica,sans-serif')
            .attr('font-size', '0.8rem')
            .attr('x', x)
            .attr('y', y)
            .attr('fill', "white")
            .text(text)
          }

          if (node.state !== null){

            let xOffset = 0
            let yOffset = 0
            for(let i = 0; i < node.state.length; i++) {
              if (node.state[i] == 1) {
                placeKagglePiece(svg, xOffset, yOffset)
              } else if (node.state[i] == -1) {
                placeGoosePiece(svg, xOffset, yOffset)
              }

              xOffset = xOffset + 160 + margin
            }

            placeEmptySlot(svg, 0,   0);
            placeEmptySlot(svg, 160 + margin, 0);
            placeEmptySlot(svg, 320 + margin + margin, 0);
            placeEmptySlot(svg, 480 + margin + margin + margin, 0);
          }
      }

      function drawTree(containerId, showStates) {
        let width = 1700

        let boardHeight = 15;
        let boardWidth = 63;

        let y = 25;
        let root = new Node(860-32, y, [0,0,0,0], null, 1)

        y = 125
        let r1c1 = new Node(2*1700/12/2, y, [1,  0,  0,  0], root, -1)
        let r1c2 = new Node(9*1700/12/2, y, [0,  1,  0,  0], root, -1)
        let r1c3 = new Node(14*1700/12/2, y, [0,  0,  1,  0], root, -1)
        let r1c4 = new Node(21*1700/12/2, y, [0,  0,  0,  1], root, -1)

        y = 225
        let r2c1 = new Node(1*1700/12/2/2, y, [1, -1,  0,  0], r1c1, 1)
        let r2c2 = new Node(4*1700/12/2/2, y, [1,  0, -1,  0], r1c1, 1)
        let r2c3 = new Node(7*1700/12/2/2, y, [1,  0,  0, -1], r1c1, 1)
        
        let r2c4 = new Node(14*1700/12/2/2, y, [-1,  1,  0,  0], r1c2, 1)
        let r2c5 = new Node(17*1700/12/2/2, y, [ 0,  1, -1,  0], r1c2, 1)
        let r2c6 = new Node(20*1700/12/2/2, y, [ 0,  1,  0, -1], r1c2, 1)
        
        let r2c7 = new Node(26*1700/12/2/2, y, [-1,  0,  1,  0], r1c3, 1)
        let r2c8 = new Node(29*1700/12/2/2, y, [ 0, -1,  1,  0], r1c3, 1)
        let r2c9 = new Node(32*1700/12/2/2, y, [ 0,  0,  1, -1], r1c3, 1)
        
        let r2c10 = new Node(39*1700/12/2/2, y, [-1,  0,  0,  1], r1c4, 1)
        let r2c11 = new Node(42*1700/12/2/2, y, [ 0, -1,  0,  1], r1c4, 1)
        let r2c12 = new Node(45*1700/12/2/2, y, [ 0,  0, -1,  1], r1c4, 1)

        y = 325
        let r3c1 = new Node(0*1700/12/2/2, y, [ 1, -1,  1,  0], r2c1, -1)
        let r3c2 = new Node(2*1700/12/2/2, y, [ 1, -1,  0,  1], r2c1, -1)
        
        let r3c3 = new Node(4*1700/12/2/2, y, [ 1,  1, -1,  0], r2c2, -1)
        let r3c4 = new Node(6*1700/12/2/2, y, [ 1,  0, -1,  1], r2c2, -1)

        let r3c5 = new Node(8*1700/12/2/2, y,  [ 1,  1,  0, -1], r2c3, -1)
        let r3c6 = new Node(10*1700/12/2/2, y, [ 1,  0,  1, -1], r2c3, -1)
        
        let r3c7 = new Node(12*1700/12/2/2, y, [-1,  1,  1,  0], r2c4, -1)
        let r3c8 = new Node(14*1700/12/2/2, y, [-1,  1,  0,  1], r2c4, -1)
        
        let r3c9  = new Node(16*1700/12/2/2, y, [ 1,  1, -1,  0], r2c5, -1)
        let r3c10 = new Node(18*1700/12/2/2, y, [ 0,  1, -1,  1], r2c5, -1)
        
        let r3c11 = new Node(20*1700/12/2/2, y, [ 1,  1,  0, -1], r2c6, -1)
        let r3c12 = new Node(22*1700/12/2/2, y, [ 0,  1,  1, -1], r2c6, -1)
        
        let r3c13 = new Node(24*1700/12/2/2, y, [-1,  1,  1,  0], r2c7, -1)
        let r3c14 = new Node(26*1700/12/2/2, y, [-1,  0,  1,  1], r2c7, -1)
        
        let r3c15 = new Node(28*1700/12/2/2, y, [ 1, -1,  1,  0], r2c8, -1)
        let r3c16 = new Node(30*1700/12/2/2, y, [ 0, -1,  1,  1], r2c8, -1)
        
        let r3c17 = new Node(32*1700/12/2/2, y, [ 1,  0,  1, -1], r2c9, -1)
        let r3c18 = new Node(34*1700/12/2/2, y, [ 0,  1,  1, -1], r2c9, -1)
        
        let r3c19 = new Node(36*1700/12/2/2, y, [-1,  1,  0,  1], r2c10, -1)
        let r3c20 = new Node(38*1700/12/2/2, y, [-1,  0,  1,  1], r2c10, -1)
        
        let r3c21 = new Node(40*1700/12/2/2, y, [ 1, -1,  0,  1], r2c11, -1)
        let r3c22 = new Node(42*1700/12/2/2, y, [ 0, -1,  1,  1], r2c11, -1)
        
        let r3c23 = new Node(44*1700/12/2/2, y, [ 1,  0, -1,  1], r2c12, -1)
        let r3c24 = new Node(46*1700/12/2/2, y, [ 0,  1, -1,  1], r2c12, -1)

        y = 425
        let r4c1 = new Node(0*1700/12/2/2, y, [ 1, -1,  1, -1], r3c1, -1)
        let r4c2 = new Node(2*1700/12/2/2, y, [ 1, -1, -1,  1], r3c2, -1)

        let r4c3 = new Node(6*1700/12/2/2, y, [ 1, -1, -1,  1], r3c4, 1)

        let r4c4 = new Node(10*1700/12/2/2, y, [ 1, -1,  1, -1], r3c6, 1)

        let r4c5 = new Node(14*1700/12/2/2, y, [-1,  1, -1,  1], r3c8, 1)

        let r4c6 = new Node(18*1700/12/2/2, y, [-1,  1, -1,  1], r3c10, 1)

        let r4c7 = new Node(28*1700/12/2/2, y, [1, -1,  1, -1], r3c15, 1)

        let r4c8 = new Node(32*1700/12/2/2, y, [ 1, -1,  1, -1], r3c17, 1)

        let r4c9 = new Node(36*1700/12/2/2, y, [-1,  1, -1,  1], r3c19, 1)

        let r4c10 = new Node(40*1700/12/2/2, y, [ 1, -1, -1,  1], r3c21, 1)

        let r4c11 = new Node(44*1700/12/2/2, y, [ 1, -1, -1,  1], r3c23, 1)
        let r4c12 = new Node(46*1700/12/2/2, y, [-1,  1, -1,  1], r3c24, 1)

        // Place edges
        placeTree(containerId, root, showStates)
        placeEdges(containerId, root)
      }

      function drawCircle(containerId, x, y) {

        let circle = d3.select(containerId)
          .append('circle')
          .attr('cx', x)
          .attr('cy', y)
          .attr('r', 20)
          .attr('fill', '#000b2a')
          .attr('stroke', 'rgba(255, 255, 255, 0.8)')
          .attr('stroke-width', '1')
      }

      function placeArrow(containerId, x1, y1, x2, y2) {

        d3.select(containerId).append("svg:defs").append("svg:marker")
          .attr("id", "triangle")
          .attr("refX", 6)
          .attr("refY", 6)
          .attr("markerWidth", 30)
          .attr("markerHeight", 30)
          .attr("orient", "auto")
          .append("path")
          .attr("d", "M 0 0 12 6 0 12 3 6")
          .style("fill", "black");

      }

      let showStates = false;
      drawTree("#tree svg", showStates);

      showStates = true;
      drawTree("#treeWithStates svg", showStates)
      


      // x = 1700/12/2/2;
      // y = 200
      // for (let i = 0; i < 12; i++) {
      //   placeEmptyBoard(containerId, x, y)
      //   x = x + 1700/12;
      // }
      
      // x = 0
      // y = 300
      // for (let i = 0; i < 24; i++) {
      //   placeEmptyBoard(containerId, x, y)
      //   x = x + 1700/24;
      // }

    </script>
</body>
</html>